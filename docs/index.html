<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<!-- BEGIN opengraph metadata -->
<meta property="og:title" content="boost.fairness" />
<meta property="og:image" content="https://sernior.github.io/fairness/logo1.png" />
<meta property="og:description" content="A collection of advanced syncronization mechanisms." />
<meta property="og:url" content="https://github.com/Sernior/fairness" />
<!-- END opengraph metadata -->
<!-- BEGIN twitter metadata -->
<meta name="twitter:image:src" content="https://sernior.github.io/fairness/logo1.png" />
<meta name="twitter:title" content="boost.fairness" />
<meta name="twitter:description" content="A collection of advanced syncronization mechanisms." />
<!-- END twitter metadata -->
<title>fairness: boost.fairness</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/png" href="logo1-favicon.png" style="border-radius: 10%;"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
<script type="text/javascript" src="toggle-alternative-theme.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeTabs.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="custom-alternative.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- https://tholman.com/github-corners/ -->
<a href="https://github.com/Sernior/fairness" class="github-corner" title="View source on GitHub" target="_blank">
    <svg viewBox="0 0 250 250" width="70" height="70" style="position: absolute; top: 0; border: 0; right: 0; z-index: 99;" aria-hidden="true">
    <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo1.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">fairness
   &#160;<span id="projectnumber">v0.1</span>
   </div>
   <div id="projectbrief">A collection of advanced syncronization mechanisms.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title"><a class="el" href="namespaceboost_1_1fairness.html">boost.fairness</a> </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md__r_e_a_d_m_e"></a> <a href="https://github.com/Sernior/fairness/releases/latest"><img src="https://img.shields.io/github/v/release/Sernior/fairness" alt="GitHub release (latest by date)" class="inline"/></a> <a href="https://github.com/Sernior/fairness/blob/main/LICENSE"><img src="https://img.shields.io/github/license/Sernior/fairness" alt="GitHub" class="inline"/></a> <img src="https://img.shields.io/github/stars/Sernior/fairness" alt="GitHub Repo stars" class="inline"/></p>
<blockquote class="doxtable">
<p>&zwj;[!NOTE] <br  />
 <span style="color: red;">This is not currently part of the Boost library collection.<br  />
 However, my intention is to submit it for review once it's fully completed.</span> </p>
</blockquote>
<p><b>A collection of advanced syncronization mechanisms which are able to prioritize threads based on their priority, granting higher-priority threads access to protected resources ahead of lower-priority ones.</b></p>
<p><b>Designed to enhance throughput in pipelines by prioritizing slower threads.</b></p>
<p><a class="anchor" id="readme-top"></a></p>
<div align="center"> </div><div align="center"> <em>A C++ library containing a collection of advanced syncronization mechanisms.</em> </div><div align="center"> </div><h1><a class="anchor" id="autotoc_md10"></a>
About The Project</h1>
<p>While the standard library offers various tools for managing concurrency, it lacks effective methods for enforcing fairness policies among threads.<br  />
 Tweaking such behaviors can be challenging, and mistakes might lead to issues like thread starvation. These tools, if misused, have the potential to cause harm rather than benefit. Careful implementation and understanding are crucial to harness their benefits effectively.<br  />
 The advanced syncronization mechanisms in this library do not autonomously adjust priorities, which means there is a risk of thread starvation if new threads are continually created and given high-priority locks; the primary intention behind creating these syncronization mechanisms is for their utilization within completed pipelines. In this context, the risk of thread starvation is non-existent due to the established pipeline structure.</p>
<p>The assumptions are:</p><ul>
<li>The pipeline operates in a multi-threaded manner;</li>
<li>the pipeline is finite.</li>
</ul>
<p><img src="https://sernior.github.io/fairness/stdpipeline.png" alt="" class="readme-img" style="object-fit: cover; object-position: 100% 0; width: 100%;" class="inline"/></p>
<p><img src="https://sernior.github.io/fairness/prioritypipeline.png" alt="" class="readme-img" style="object-fit: cover; object-position: 100% 0; width: 100%;" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md11"></a>
Getting Started</h1>
<h2><a class="anchor" id="autotoc_md12"></a>
Prerequisites</h2>
<p>I build and tested this lib with C++20. <br  />
 If for some reason, on some compilers (not MinGW), it doesn`t work on C++20+ please email me or open an issue.</p>
<h2><a class="anchor" id="autotoc_md13"></a>
Setup boost library</h2>
<p>Download <a href="https://www.boost.org/users/history/version_1_82_0.html">https://www.boost.org/users/history/version_1_82_0.html</a></p>
<p>In the directory where you want to put the Boost installation, execute: </p><pre class="fragment">```sh
$ tar --bzip2 -xf /path/to/boost_1_82_0.tar.bz2
$ ./bootstrap.sh --prefix=/usr/local
$ ./b2 install
```
</pre> <h2><a class="anchor" id="autotoc_md14"></a>
Setup</h2>
<p>This is an header only library but you can build the tests using:</p>
<p>Generate ninja build files and build:</p>
<div class="fragment"><div class="line">$ cmake . -B build -G Ninja -DLIBFSM_COMPILE_TESTS=ON -DLIBFSM_COMPILE_BENCHMARKS=ON</div>
<div class="line">$ cmake --build build</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md15"></a>
Installation</h2>
<p>Using cmake you can include this library using:</p>
<div class="fragment"><div class="line">include(FetchContent)</div>
<div class="line"> </div>
<div class="line">FetchContent_Declare(</div>
<div class="line">  fsm</div>
<div class="line">  GIT_REPOSITORY https://github.com/Sernior/priority-mutex.git</div>
<div class="line">  GIT_TAG [TAG] #change with the tag you want to use</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line">FetchContent_MakeAvailable(fsm)</div>
</div><!-- fragment --><p> At this point you should be able to link the library simply using: </p><div class="fragment"><div class="line">target_link_libraries(your_stuff.cpp fsm)</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md16"></a>
Snippet</h1>
<p>This is a snippet ready-to-use. </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;thread&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;chrono&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;BS_thread_pool.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fairness_8hpp.html">boost/fairness.hpp</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> boost::fairness::slim_priority_mutex&lt;4&gt; ms;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> busy_wait_nano(uint64_t nanoseconds){</div>
<div class="line">    <span class="keyword">auto</span> begin = std::chrono::steady_clock::now();</div>
<div class="line">    <span class="keywordflow">for</span>(;std::chrono::duration_cast&lt;std::chrono::nanoseconds&gt;(std::chrono::steady_clock::now() - begin).count() &lt; nanoseconds;)</div>
<div class="line">        <span class="keywordflow">continue</span>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> thread_function_nano(<span class="keywordtype">int</span> p, <span class="keywordtype">int</span> preCriticalTime, <span class="keywordtype">int</span> postCriticalTime, <span class="keywordtype">int</span> criticalTime){</div>
<div class="line">    busy_wait_nano(preCriticalTime);</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_class" href="classboost_1_1fairness_1_1unique__lock.html">boost::fairness::unique_lock</a> l1(ms, p);</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Thread with priority : &quot;</span> &lt;&lt; p &lt;&lt; <span class="stringliteral">&quot; is running.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        busy_wait_nano(criticalTime);</div>
<div class="line">    }</div>
<div class="line">    busy_wait_nano(postCriticalTime);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="example_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>()</div>
<div class="line">{</div>
<div class="line">    std::array&lt;int, 8&gt; prios {0, 2, 2, 1, 1, 3, 3, 0};</div>
<div class="line">    std::array&lt;int, 8&gt; preCT {2000, 1500, 2000, 3000, 1000, 500, 500, 2000};</div>
<div class="line">    std::array&lt;int, 8&gt; postCT {5000, 3000, 2000, 2500, 1000, 1500, 1500, 4500};</div>
<div class="line">    <span class="keywordtype">int</span> criticalTime = 1000;</div>
<div class="line"> </div>
<div class="line">    BS::thread_pool pool(8);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 8; ++i){</div>
<div class="line">        pool.push_task(thread_function_nano, prios[i], preCT[i], postCT[i], criticalTime);</div>
<div class="line">    }</div>
<div class="line">    pool.wait_for_tasks();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="aclassboost_1_1fairness_1_1unique__lock_html"><div class="ttname"><a href="classboost_1_1fairness_1_1unique__lock.html">boost::fairness::unique_lock</a></div><div class="ttdoc">The class unique_lock is a general-purpose mutex ownership wrapper allowing deferred locking,...</div><div class="ttdef"><b>Definition</b> unique_lock.hpp:35</div></div>
<div class="ttc" id="aexample_8cpp_html_ae66f6b31b5ad750f1fe042a706a4e3d4"><div class="ttname"><a href="example_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a></div><div class="ttdeci">int main()</div><div class="ttdef"><b>Definition</b> example.cpp:14</div></div>
<div class="ttc" id="afairness_8hpp_html"><div class="ttname"><a href="fairness_8hpp.html">fairness.hpp</a></div><div class="ttdoc">This file contains the all the includes required by the library.</div></div>
</div><!-- fragment --><p>The output of the above could be:</p>
<div class="fragment"><div class="line">Thread with priority : 0 is running.</div>
<div class="line">Thread with priority : 0 is running.</div>
<div class="line">Thread with priority : 1 is running.</div>
<div class="line">Thread with priority : 1 is running.</div>
<div class="line">Thread with priority : 2 is running.</div>
<div class="line">Thread with priority : 2 is running.</div>
<div class="line">Thread with priority : 3 is running.</div>
<div class="line">Thread with priority : 3 is running.</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md17"></a>
Configurations</h1>
<p>This is a list of macros that can be defined to configure <a class="el" href="namespaceboost_1_1fairness.html">boost::fairness</a>:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">MACRO   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">BOOST_FAIRNESS_EXPERIMENTAL_MUTEXES   </td><td class="markdownTableBodyNone">Allow the inclusion of the experimental mutexes.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">BOOST_FAIRNESS_WAIT_SPINS   </td><td class="markdownTableBodyNone">The number of unpaused spins before a syscall to the OS to yield the cpu through futex on linux or waitOnAdress on windows.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">BOOST_FAIRNESS_WAIT_SPINS_RELAXED   </td><td class="markdownTableBodyNone">the number of paused spins before a syscall to the OS to yield the cpu through futex on linux or waitOnAdress on windows.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">BOOST_FAIRNESS_HAS_DWCAS   </td><td class="markdownTableBodyNone">if the hardware supports cmpxch16b and boost::atomic is present then allow <a class="el" href="namespaceboost_1_1fairness.html">boost::fairness</a> to use cmpxch16b.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">BOOST_FAIRNESS_USE_STD_WAIT_NOTIFY   </td><td class="markdownTableBodyNone"><a class="el" href="namespaceboost_1_1fairness.html">boost::fairness</a> will use atomic::wait/notify implemented by the standard lib instead of its own implementation.   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md18"></a>
Contributing</h1>
<p>If you encounter any issues or would like to suggest new features, please don't hesitate to open an issue or get in touch with me at <a href="#" onclick="location.href='mai'+'lto:'+'fed'+'er'+'ign'+'ol'+'i@h'+'ot'+'mai'+'l.'+'it'; return false;">feder<span class="obfuscator">.nosp@m.</span>igno<span class="obfuscator">.nosp@m.</span>li@ho<span class="obfuscator">.nosp@m.</span>tmai<span class="obfuscator">.nosp@m.</span>l.it</a>.<br  />
 Contributions are also welcome! Feel free to open pull requests to the main repository and assign me as a reviewer â€“ I'll be sure to review them. Your help is greatly appreciated!</p>
<h1><a class="anchor" id="autotoc_md19"></a>
License</h1>
<p>Distributed under the Boost Software License - Version 1.0. See LICENSE.txt for more information.</p>
<h1><a class="anchor" id="autotoc_md20"></a>
Documentation</h1>
<p>The documentation is available at the following link: <a href="https://sernior.github.io/fairness/">https://sernior.github.io/fairness/</a></p>
<h1><a class="anchor" id="autotoc_md21"></a>
Contacts</h1>
<p>Federico Abrignani - <a href="#" onclick="location.href='mai'+'lto:'+'fed'+'er'+'ign'+'ol'+'i@h'+'ot'+'mai'+'l.'+'it'; return false;">feder<span class="obfuscator">.nosp@m.</span>igno<span class="obfuscator">.nosp@m.</span>li@ho<span class="obfuscator">.nosp@m.</span>tmai<span class="obfuscator">.nosp@m.</span>l.it</a><br  />
 Salvatore Martorana - <a href="#" onclick="location.href='mai'+'lto:'+'sal'+'va'+'tor'+'em'+'art'+'or'+'ana'+'@h'+'otm'+'ai'+'l.c'+'om'; return false;">salva<span class="obfuscator">.nosp@m.</span>tore<span class="obfuscator">.nosp@m.</span>marto<span class="obfuscator">.nosp@m.</span>rana<span class="obfuscator">.nosp@m.</span>@hotm<span class="obfuscator">.nosp@m.</span>ail.<span class="obfuscator">.nosp@m.</span>com</a></p>
<h1><a class="anchor" id="autotoc_md22"></a>
Authors and Contributors</h1>
<p><a href="https://github.com/Sernior/fairness/graphs/contributors"><img src="https://contrib.rocks/image?repo=Sernior/fairness" alt="" class="inline"/> </a> </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
